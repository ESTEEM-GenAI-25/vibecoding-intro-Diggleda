<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Portfolio Website PRD Â· Peter J. Gibbons</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --fg: #142750;
        --fg-secondary: #2d3f6e;
        --card-bg: rgba(255, 255, 255, 0.96);
        --accent: #1a2f6b;
        --shadow: 0 24px 60px rgba(20, 39, 80, 0.16);
        --radius: 28px;
        --blur: blur(20px);
        --max-width: 1100px;
        --hero-padding-max: clamp(44px, 9vw, 64px);
        --hero-padding-min: 8px;
        --hero-gap-max: 18px;
        --hero-gap-min: 0px;
        --hero-title-max: clamp(2.8rem, 5.4vw, 3.9rem);
        --hero-title-min: clamp(1.95rem, 4.2vw, 2.4rem);
        --hero-compact-width: clamp(320px, 55vw, 640px);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: #ffffff;
        color: var(--fg);
        display: flex;
        justify-content: center;
        padding: clamp(42px, 6vw, 72px);
        position: relative;
      }

      body::before {
        content: "";
        position: fixed;
        inset: 0;
        z-index: -1;
        pointer-events: none;
        background: url('photos/Background.webp') center top / cover no-repeat;
        opacity: 0.9;
        mask-image: linear-gradient(to bottom, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0.75) 35%, rgba(0, 0, 0, 0.2) 50%, rgba(0, 0, 0, 0) 100%);
        -webkit-mask-image: linear-gradient(to bottom, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0.75) 35%, rgba(0, 0, 0, 0.2) 70%, rgba(0, 0, 0, 0) 100%);
      }

      .page {
        width: min(100%, var(--max-width));
        display: grid;
        gap: clamp(48px, 8vw, 80px);
        margin: 0 auto;
      }

      .page-header {
        position: sticky;
        top: clamp(12px, 3vw, 32px);
        z-index: 10;
        width: 100%;
        margin-bottom: 0;
        padding-bottom: clamp(48px, 8vw, 96px);
        display: flex;
        justify-content: center;
        --shrink-progress: 0;
        --hero-bg-opacity: 0.12;
      }

      .hero {
        /* Full-width within page container */
        width: 100%;
        max-width: clamp(
          var(--hero-compact-width),
          calc(var(--max-width) * (1 - var(--shrink-progress)) + var(--hero-compact-width) * var(--shrink-progress)),
          var(--max-width)
        );
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: justify;
        text-align-last: center;
        padding: calc(
          var(--hero-padding-min) +
            (var(--hero-padding-max) - var(--hero-padding-min)) *
            (1 - var(--shrink-progress))
        );
        min-height: clamp(56px, 9vh, 96px);
        gap: calc( var(--hero-gap-max) * (1 - var(--shrink-progress)) );
        background: rgba(255, 255, 255, var(--hero-bg-opacity));
        backdrop-filter: var(--blur);
        -webkit-backdrop-filter: var(--blur);
        border-radius: var(--radius);
        border: 1px solid rgba(255, 255, 255, 0.55);
        box-shadow: 0 28px 58px rgba(15, 23, 42, 0.08);
        transition: box-shadow 0.6s ease, background 0.6s ease, padding 0.45s ease, min-height 0.45s ease, max-width 0.55s cubic-bezier(0.22, 0.61, 0.36, 1), width 0.55s cubic-bezier(0.22, 0.61, 0.36, 1);
        will-change: padding, gap;
      }

      .hero h1 {
        margin: 0;
        text-align: justify;
        text-align-last: justify;
        font-size: calc(
          var(--hero-title-min) +
            (var(--hero-title-max) - var(--hero-title-min)) *
            (1 - var(--shrink-progress))
        );
        line-height: 1.05;
        padding: 0 clamp(6px, 1.5vw, 14px);
        letter-spacing: -0.01em;
        max-width: 760px;
      }

      .hero p {
        margin: 0;
        text-align: justify;
        text-align-last: justify;
        font-size: clamp(1.05rem, 2.4vw, 1.26rem);
        color: var(--fg-secondary);
        line-height: 1.72;
        max-width: 720px;
        max-height: calc(320px * (1 - var(--shrink-progress)));
        opacity: clamp(0, 1 - 1.05 * var(--shrink-progress), 1);
        transform: translateY(calc(-10px * var(--shrink-progress)));
        overflow: hidden;
        transition: opacity 0.25s linear, transform 0.25s linear, max-height 0.25s linear;
      }

      .hero .content-list {
        margin: 6px 0 0;
        gap: 4px;
        max-height: calc(360px * (1 - var(--shrink-progress)));
        opacity: clamp(0, 1 - 1.05 * var(--shrink-progress), 1);
        transform: translateY(calc(-10px * var(--shrink-progress)));
        overflow: hidden;
        transition: opacity 0.25s linear, transform 0.25s linear, max-height 0.25s linear;
      }

      .hero .content-list li {
        padding: 0;
        background: transparent;
        border: none;
        box-shadow: none;
        gap: 4px;
        text-align: justify;
      }

      .hero-photo {
        width: clamp(120px, 22vw, 180px);
        height: clamp(140px, 22vw, 200px);
        border-radius: 24px;
        object-fit: cover;
        box-shadow: 0 18px 40px rgba(20, 39, 80, 0.18);
        border: 3px solid rgba(255, 255, 255, 0.75);
        margin: clamp(0px, 4vw, 5px) 0;
        transition:
          opacity 0.28s ease,
          transform 0.28s ease,
          max-height 0.28s ease,
          margin 0.28s ease;
      }

      .hero .content-list li p {
        text-align: justify;
        text-align-last: justify;
      }

      .hero.hero--compact {
        /* When compact, revert to content-width pill and center */
        width: auto;
        max-width: var(--hero-compact-width);
        margin-left: auto;
        margin-right: auto;
        padding: clamp(12px, 3vw, 20px);
        min-height: clamp(56px, 9vh, 96px);
        gap: var(--hero-gap-min);
        display: inline-flex;
        flex-direction: column;
        align-items: center;
      }

      .hero .content-list li strong {
        font-size: 0.92rem;
        color: rgba(17, 19, 24, 0.72);
        text-transform: uppercase;
        letter-spacing: 0.08em;
        text-align: justify;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        background: rgba(26, 47, 107, 0.14);
        border-radius: 999px;
        padding: calc(9px * (1 - var(--shrink-progress)))
          calc(18px * (1 - var(--shrink-progress)));
        max-height: calc(38px * (1 - var(--shrink-progress)));
        font-weight: 600;
        color: var(--accent);
        box-shadow: inset 0 0 0 calc(1px * (1 - var(--shrink-progress)))
          rgba(26, 47, 107, 0.28);
        text-transform: uppercase;
        font-size: 0.82rem;
        letter-spacing: 0.08em;
        transition:
          transform 0.25s linear,
          opacity 0.25s linear,
          padding 0.25s linear,
          max-height 0.25s linear,
          box-shadow 0.25s linear;
        transform: translateY(calc(-4px * var(--shrink-progress)));
        opacity: calc(1 - var(--shrink-progress));
      }

      main {
        display: grid;
        gap: clamp(44px, 7vw, 72px);
        margin-top: clamp(60px, 12vw, 120px);
      }

      section {
        display: grid;
        gap: 28px;
        background: var(--card-bg);
        backdrop-filter: var(--blur);
        -webkit-backdrop-filter: var(--blur);
        padding: clamp(32px, 6vw, 48px);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border: 1px solid rgba(208, 216, 232, 0.78);
        scroll-margin-top: clamp(140px, 20vh, 220px);
      }

      section h2 {
        margin: 0;
        font-size: clamp(1.8rem, 3.4vw, 2.3rem);
      }

      .timeline {
        display: grid;
        gap: 32px;
        position: relative;
        padding-left: clamp(26px, 5vw, 50px);
      }

      .timeline::before {
        content: "";
        position: absolute;
        top: var(--radius);
        bottom: var(--radius);
        left: 0;
        width: 2px;
        background: linear-gradient(#cbd5f5, rgba(26, 47, 107, 0.24));
        opacity: 0.35;
      }

      .timeline-item {
        position: relative;
        padding: clamp(22px, 4vw, 32px);
        padding-left: clamp(26px, 5vw, 42px);
        background: rgba(255, 255, 255, 0.95);
        border-radius: calc(var(--radius) - 12px);
        border: 1px solid rgba(208, 216, 232, 0.92);
        box-shadow: 0 20px 45px rgba(15, 23, 42, 0.12);
        display: grid;
        gap: 16px;
      }

      .timeline-item::before {
        display: none;
      }

      .timeline-item h3 {
        margin: 0;
        font-size: clamp(1.24rem, 2.5vw, 1.54rem);
      }

      .timeline-date {
        margin: 0;
        font-weight: 600;
        color: var(--accent);
        font-size: 0.96rem;
        letter-spacing: 0.04em;
        text-transform: uppercase;
      }

      .timeline-description {
        margin: 0;
        color: var(--fg-secondary);
        line-height: 1.7;
      }

      .resource-links {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
      }

      .resource-links a {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 10px 18px;
        border-radius: 999px;
        background: rgba(10, 38, 116, 0.16);
        color: var(--accent);
        text-decoration: none;
        font-weight: 600;
        font-size: 0.92rem;
        transition: none;
      }

      .resource-links a:hover {
        transform: none;
        box-shadow: none;
      }

      .media-image {
        width: 100%;
        border-radius: calc(var(--radius) - 16px);
        border: 1px solid rgba(194, 204, 224, 0.82);
        box-shadow: 0 14px 32px rgba(15, 23, 42, 0.12);
      }

      .contact-card {
        align-items: center;
        text-align: center;
      }

      .contact-card p {
        max-width: 460px;
        margin: 0 auto;
        color: var(--fg-secondary);
        line-height: 1.7;
      }

      .contact-actions {
        display: inline-flex;
        gap: 12px;
        align-items: center;
        justify-content: center;
        margin: 12px auto 0;
      }

      .contact-button {
        justify-self: center;
        display: inline-flex;
        align-items: center;
        padding: 14px 28px;
        background: var(--accent);
        color: white;
        border-radius: 999px;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.02rem;
        box-shadow: 0 18px 35px rgba(90, 103, 216, 0.35);
        transition: transform 0.28s ease, box-shadow 0.28s ease;
      }

      .contact-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 22px 42px rgba(90, 103, 216, 0.4);
      }

      .contact-button.secondary {
        background: transparent;
        color: var(--accent);
        box-shadow: inset 0 0 0 1px rgba(90, 103, 216, 0.38);
      }

      .contact-button.secondary:hover {
        box-shadow:
          inset 0 0 0 1px rgba(90, 103, 216, 0.6),
          0 12px 28px rgba(90, 103, 216, 0.18);
      }

      .footer-note {
        margin: 0;
        font-size: 0.95rem;
        color: var(--fg-secondary);
        text-align: center;
      }

      @media (max-width: 720px) {
        body {
          padding: clamp(18px, 6vw, 40px);
        }

        .page-header {
          top: clamp(6px, 4vw, 16px);
          padding-bottom: clamp(28px, 10vw, 56px);
          display: flex;
          justify-content: center;
        }

        .hero {
          width: 100%;
          max-width: none;
          min-height: clamp(56px, 9vh, 96px);
          padding: clamp(14px, 7vw, 26px);
          gap: clamp(8px, 5vw, 18px);
          text-align: justify;
          text-align-last: justify;
        }

        .hero h1 {
          font-size: clamp(1.8rem, 7vw, 2.4rem);
          line-height: 1.18;
          text-align: justify;
          text-align-last: justify;
          padding: 0 clamp(6px, 4vw, 14px);
        }

        .hero p {
          text-align: justify;
          text-align-last: justify;
          font-size: clamp(0.95rem, 4.2vw, 1.18rem);
        }

        .hero .content-list {
          text-align: justify;
        }

        .hero.hero--compact {
          width: auto;
          max-width: clamp(320px, 70vw, 640px);
          min-height: clamp(56px, 9vh, 96px);
          display: inline-flex;
          flex-direction: column;
          align-items: center;
          margin-left: auto;
          margin-right: auto;
          padding: clamp(10px, 2.6vw, 18px);
        }

        main {
          margin-top: clamp(36px, 14vw, 72px);
        }

        .timeline-item {
          padding: clamp(18px, 8vw, 28px);
        }

        .timeline {
          padding-left: clamp(20px, 6vw, 32px);
        }

        .timeline::before {
          left: clamp(9px, 4vw, 15px);
        }

        .timeline-item::before {
          left: -12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="page">
      <header class="page-header">
        <div class="hero" id="hero"></div>
      </header>

      <main id="content"></main>

      <footer>
        <p class="footer-note" id="footer-note"></p>
      </footer>
    </div>

    <script src="content.js"></script>
    <script>
      (function () {
        const data = window.PRD_CONTENT || {};

        const heroRoot = document.getElementById("hero");
        if (heroRoot && data.hero) {
          heroRoot.innerHTML = "";
          if (data.hero.label) {
            const pill = document.createElement("span");
            pill.className = "pill";
            pill.textContent = data.hero.label;
            heroRoot.appendChild(pill);
          }
          if (data.hero.title) {
            const title = document.createElement("h1");
            title.textContent = data.hero.title;
            heroRoot.appendChild(title);
          }

          const portrait = document.createElement("img");
          portrait.src = "photos/PeterGibbons.png";
          portrait.alt = "Portrait of Peter J. Gibbons";
          portrait.className = "hero-photo";
          heroRoot.appendChild(portrait);

          if (data.hero.description) {
            const description = document.createElement("p");
            description.textContent = data.hero.description;
            heroRoot.appendChild(description);
          }
          if (Array.isArray(data.hero.meta) && data.hero.meta.length) {
            const metaList = document.createElement("ul");
            metaList.className = "content-list";
            data.hero.meta.forEach((entry) => {
              const li = document.createElement("li");
              const strong = document.createElement("strong");
              strong.textContent = entry.label;
              li.appendChild(strong);
              const copy = document.createElement("p");
              copy.textContent = entry.body;
              li.appendChild(copy);
              metaList.appendChild(li);
            });
            heroRoot.appendChild(metaList);
          }
        }

        const contentRoot = document.getElementById("content");
        const projects = Array.isArray(data.projects) ? data.projects : [];

        if (contentRoot && projects.length) {
          projects.forEach((project) => {
            const node = document.createElement("section");
            node.className = "timeline-item";

            if (project.title) {
              const title = document.createElement("h3");
              title.textContent = project.title;
              node.appendChild(title);
            }

            if (project.date) {
              const date = document.createElement("p");
              date.className = "timeline-date";
              date.textContent = project.date;
              node.appendChild(date);
            }

            if (project.description) {
              const description = document.createElement("p");
              description.className = "timeline-description";
              description.textContent = project.description;
              node.appendChild(description);
            }

            if (project.image) {
              const img = document.createElement("img");
              img.src = project.image;
              img.alt = project.imageAlt || project.title || "Project image";
              img.className = "media-image";
              node.appendChild(img);
            }

            if (project.download || (project.links && project.links.length)) {
              const links = document.createElement("div");
              links.className = "resource-links";

              if (project.download) {
                const downloadLink = document.createElement("a");
                downloadLink.href = project.download;
                downloadLink.textContent = project.downloadLabel || "Download";
                downloadLink.setAttribute("download", "");
                downloadLink.target = "_blank";
                downloadLink.rel = "noopener noreferrer";
                links.appendChild(downloadLink);
              }

              if (project.links && project.links.length) {
                project.links.forEach((link) => {
                  const anchor = document.createElement("a");
                  anchor.href = link.href;
                  anchor.textContent = link.label;
                  anchor.target = link.target || "_blank";
                  anchor.rel = "noopener noreferrer";
                  links.appendChild(anchor);
                });
              }

              node.appendChild(links);
            }

            contentRoot.appendChild(node);
          });
        }

        if (contentRoot && data.contact) {
          const contactSection = document.createElement("section");
          contactSection.classList.add("contact-card");
          if (data.contact.title) {
            const title = document.createElement("h2");
            title.textContent = data.contact.title;
            contactSection.appendChild(title);
          }
          if (data.contact.body) {
            const copy = document.createElement("p");
            copy.textContent = data.contact.body;
            contactSection.appendChild(copy);
          }
          const actions = document.createElement("div");
          actions.className = "contact-actions";
          contactSection.appendChild(actions);

          if (data.contact.buttonText && data.contact.href) {
            const button = document.createElement("a");
            button.className = "contact-button";
            button.href = data.contact.href;
            button.textContent = data.contact.buttonText;
            button.target = "_blank";
            button.rel = "noopener noreferrer";
            if (data.contact.target) {
              button.target = data.contact.target;
            }
            actions.appendChild(button);
          }

          const linkedinButton = document.createElement("a");
          linkedinButton.className = "contact-button secondary";
          linkedinButton.href = "https://www.linkedin.com/in/peter-gibbons7";
          linkedinButton.textContent = "LinkedIn";
          linkedinButton.target = "_blank";
          linkedinButton.rel = "noopener noreferrer";
          actions.appendChild(linkedinButton);
          contentRoot.appendChild(contactSection);
        }

        const footerNote = document.getElementById("footer-note");
        if (footerNote && data.footerNote) {
          footerNote.textContent = data.footerNote;
        }

        const header = document.querySelector(".page-header");
        const heroElement = document.getElementById("hero");
        if (header) {
          const distance = (data.hero && data.hero.shrinkDistance) ? data.hero.shrinkDistance : 160;
          const startBuffer = (data.hero && data.hero.shrinkOffset) ? data.hero.shrinkOffset : 20;
          const minOpacity = 0.06;
          const maxOpacity = 0.18;
          const THRESH_ON = 0.82;
          const THRESH_OFF = 0.68;

          const clampProgress = (progress) => Math.max(0, Math.min(progress, 1));

          const applyProgress = (progress) => {
            const clamped = clampProgress(progress);
            header.style.setProperty("--shrink-progress", clamped.toFixed(3));
            const opacity = maxOpacity - (maxOpacity - minOpacity) * clamped;
            header.style.setProperty("--hero-bg-opacity", opacity.toFixed(3));

            if (heroElement) {
              const photo = heroElement.querySelector(".hero-photo");
              if (photo) {
                if (!photo.dataset.baseHeight || !photo.dataset.baseMargin) {
                  const rect = photo.getBoundingClientRect();
                  if (!photo.dataset.baseHeight) {
                    photo.dataset.baseHeight = String(rect.height || photo.offsetHeight || 160);
                  }
                  if (!photo.dataset.baseMargin) {
                    const computed = parseFloat(window.getComputedStyle(photo).marginTop) || 16;
                    photo.dataset.baseMargin = String(computed);
                  }
                }

                const baseHeight = parseFloat(photo.dataset.baseHeight || '160');
                const baseMargin = parseFloat(photo.dataset.baseMargin || '16');
                const delayed = Math.max(0, clamped - 0.1);
                const scale = Math.max(0.45, 1 - delayed * 0.7);
                const fade = Math.max(0, 1 - delayed * 1.2);
                const clampedHeight = Math.max(0, baseHeight * (1 - delayed * 1.1));
                const clampedMargin = Math.max(0, baseMargin * (1 - delayed * 1.1));

                photo.style.transform = `scale(${scale.toFixed(3)})`;
                photo.style.opacity = fade.toFixed(3);
                photo.style.maxHeight = `${clampedHeight.toFixed(1)}px`;
                photo.style.marginTop = `${clampedMargin.toFixed(1)}px`;
                photo.style.marginBottom = `${clampedMargin.toFixed(1)}px`;
                photo.style.pointerEvents = fade <= 0.05 ? 'none' : '';
              }

              const isCompact = heroElement.classList.contains("hero--compact");
              if (!isCompact && clamped >= THRESH_ON) {
                heroElement.classList.add("hero--compact");
              } else if (isCompact && clamped <= THRESH_OFF) {
                heroElement.classList.remove("hero--compact");
              }
            }
          };

          const compute = () => {
            const raw = (window.scrollY - startBuffer) / distance;
            return clampProgress(raw);
          };

          let scheduled = false;
          let pending = compute();

          const schedule = (progress) => {
            pending = progress;
            if (!scheduled) {
              scheduled = true;
              requestAnimationFrame(() => {
                scheduled = false;
                applyProgress(pending);
              });
            }
          };

          schedule(pending);
          window.addEventListener("scroll", () => schedule(compute()), { passive: true });
          window.addEventListener("resize", () => schedule(compute()));
        }
      })();
    </script>
  </body>
</html>
